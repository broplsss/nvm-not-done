var storage=[];try{storage=localStorage;}catch(e){};function resize_screen(){if(window.innerWidth<100)return;var scaleval=window.innerHeight/600;if(scaleval*1000>window.innerWidth)scaleval=window.innerWidth/1000;document.getElementById("main_div").style.transform="scale("+scaleval+","+scaleval+")";cc.Director.getInstance()._contentScaleFactor=scaleval;};function show_frontpage(n){document.getElementById("frontpage_div").style.display=n?"block":"none"}function show_level_select(){for(var n='<center>SELECT LEVEL:<br><br><table style="width:100%:">',t=0,o=!0,e,i,r,u,f=0;f<3;f++){for(n+="<tr>",e=0;e<5;e++){if(!storage["ab_level_"+t])r=!1,i="&nbsp;";else for(i="",r=storage["ab_level_"+t].split(":")[1],u=0;u<=2;u++)i+=r>u?"&#9733;":"&#9734;";n+='<td onclick="start_game('+t+');">'+(o?t+1+'<div style="margin-top:-19px;">'+i+"<\/div><\/td>":'<img src="sprites/lock.png">'),t++,r||(o=!1)}n+="<\/tr>"}n+="<\/table><\/center>",document.getElementById("level_select_div").innerHTML=n,document.getElementById("level_select_div").style.display="block"}function start_game(n){n>0&&!storage["ab_level_"+(n-1)]||(level_number=n,game.init())}function level_up(){level_number++,level_number>14&&(level_number=0),game.init()}function show_smoke(n,t,i){i==0&&(document.getElementById("smoke_div").style.display="block"),document.getElementById("smoke_div").style.left=n+"px",document.getElementById("smoke_div").style.top=t+"px",document.getElementById("smoke_div").style.backgroundPosition="0px -"+i*32+"px",i++,i<6?setTimeout("show_smoke("+n+", "+t+", "+i+");",60):document.getElementById("smoke_div").style.display="none"}function pan_back(n){if(game.focus_pos!=n&&!game_over){var t=Math.floor(Date.now()/1e3);if(t-last_hit<3)return setTimeout("pan_back("+n+");",1e3);game.focus_pos=n}}function leftClick(n){return window.focus(),n||(n=event),typeof n.which=="undefined"?n.button==1:n.which==1||n.button==0}function nrc(n){if(leftClick(n)==!1)return ce(n)}function cp(n){n||(n=event),n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="undefined"&&(n.cancelBubble=!0)}function ce(n){return n||(n=event),typeof n.preventDefault!="undefined"?n.preventDefault():typeof n.cancelBubble!="undefined"&&(n.returnValue=0,n.cancelBubble=!0),!1}var g_resources=function(){for(var t=[],i=["bg","platform","bird","enemy","sling1","sling2","sling3","ground","wood1","wood2","dirt","boulder","smoke","menu_refresh","menu_back"],n=0;n<i.length;n++)t.push({type:"image",src:"sprites/"+i[n]+".png"});return t}(),MathH={clamp:function(n,t,i){return Math.min(i,Math.max(n,t))}},BodyUserData=function(n,t){var i=this,r=t;this.isDead=!1,this.isContacted=!1,this.getObjectRoll=function(){return n},this.getFullHealth=function(){return t},this.getHealth=function(){return i.currentHealth},this.damage=function(n){this.isDead=(r-=n)<=0}},GameObjectRoll={Enemy:"Enemy",Wood:"Wood",Bird:"Bird",Boulder:"Boulder",Dirt:"Dirt"},j;Object.freeze(GameObjectRoll);var b2Body=Box2D.Dynamics.b2Body,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2EdgeChainDef=Box2D.Collision.Shapes.b2EdgeChainDef,b2EdgeShape=Box2D.Collision.Shapes.b2EdgeShape,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2Shape=Box2D.Collision.Shapes.b2Shape,b2Color=Box2D.Common.b2Color,b2internal=Box2D.Common.b2internal,b2Settings=Box2D.Common.b2Settings,b2Mat22=Box2D.Common.Math.b2Mat22,b2Mat33=Box2D.Common.Math.b2Mat33,b2Math=Box2D.Common.Math.b2Math,b2Sweep=Box2D.Common.Math.b2Sweep,b2Transform=Box2D.Common.Math.b2Transform,b2Vec2=Box2D.Common.Math.b2Vec2,b2Vec3=Box2D.Common.Math.b2Vec3,b2AABB=Box2D.Collision.b2AABB,b2Bound=Box2D.Collision.b2Bound,b2BoundValues=Box2D.Collision.b2BoundValues,b2Collision=Box2D.Collision.b2Collision,b2ContactID=Box2D.Collision.b2ContactID,b2ContactPoint=Box2D.Collision.b2ContactPoint,b2ContactListener=Box2D.Dynamics.b2ContactListener,b2Distance=Box2D.Collision.b2Distance,b2DistanceInput=Box2D.Collision.b2DistanceInput,b2DistanceOutput=Box2D.Collision.b2DistanceOutput,b2DistanceProxy=Box2D.Collision.b2DistanceProxy,b2DynamicTree=Box2D.Collision.b2DynamicTree,b2DynamicTreeBroadPhase=Box2D.Collision.b2DynamicTreeBroadPhase,b2DynamicTreeNode=Box2D.Collision.b2DynamicTreeNode,b2DynamicTreePair=Box2D.Collision.b2DynamicTreePair,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2Manifold=Box2D.Collision.b2Manifold,b2ManifoldPoint=Box2D.Collision.b2ManifoldPoint,b2Point=Box2D.Collision.b2Point,b2RayCastInput=Box2D.Collision.b2RayCastInput,b2RayCastOutput=Box2D.Collision.b2RayCastOutput,b2Segment=Box2D.Collision.b2Segment,b2SeparationFunction=Box2D.Collision.b2SeparationFunction,b2Simplex=Box2D.Collision.b2Simplex,b2SimplexCache=Box2D.Collision.b2SimplexCache,b2SimplexVertex=Box2D.Collision.b2SimplexVertex,b2TimeOfImpact=Box2D.Collision.b2TimeOfImpact,b2TOIInput=Box2D.Collision.b2TOIInput,b2World=Box2D.Dynamics.b2World,b2WorldManifold=Box2D.Collision.b2WorldManifold,ClipVertex=Box2D.Collision.ClipVertex,Features=Box2D.Collision.Features,IBroadPhase=Box2D.Collision.IBroadPhase,b2=function(){var l=this,f=0,t=0,n,s=!1,u=[],e=30,i=function(n){return n/e},o=function(n){return n*e},h=function(n){return-1*cc.RADIANS_TO_DEGREES(n)},c=function(n){return cc.DEGREES_TO_RADIANS(-1*n)},r=new b2ContactListener;return r.BeginContact=function(n){var i=n.GetFixtureA().GetBody(),r=n.GetFixtureB().GetBody(),u=i.GetUserData(),f=r.GetUserData(),t=function(n){n&&(n.isContacted=!0)};t(u),t(f)},r.EndContact=function(){},r.PreSolve=function(){},r.PostSolve=function(n,i){var f=n.GetFixtureA().GetBody(),e=n.GetFixtureB().GetBody(),o=f.GetUserData(),s=e.GetUserData(),r=i.normalImpulses[0],u;r<=2||(u=function(n,i){var u,e,f,o;!n||n.getHealth()==n.getFullHealth()&&r<12||(r>15&&!n.isDead&&n.getObjectRoll()!="Enemy"&&!creating_world&&(n.getObjectRoll()=="Bird"||n.getObjectRoll()=="Boulder"||game_over?(u=i.sprite.getPosition(),u.x<2400&&!game_over&&(e=parseInt(document.getElementById("viewport").style.marginLeft),show_smoke(u.x+e,600-u.y,0),u.y>120&&(f=parseInt(r),f>1e3&&(f=1e3),t+=f))):(sounds[sound_instance++].play(),sound_instance>5&&(sound_instance=1),last_hit=Math.floor(Date.now()/1e3))),o=n.getObjectRoll(),o===GameObjectRoll.Enemy&&n.damage(r))},u(o,f),u(s,e))},{toWorld:function(n){return i(n)},toScreen:function(n){return o(n)},initWorld:function(){f=t=0,game_over=!1,birds_gone=!1,creating_world=!0,n=new b2World(new b2Vec2(0,-10),!0),n.SetContinuousPhysics(!0),n.SetContactListener(r),setTimeout("creating_world=false;",2e3),u=[],document.getElementById("score_div").innerHTML="000000"},getUserScore:function(){return t},enablePhysicsFor:function(t){var o=new b2BodyDef,s={x:t.sprite.getScaleX(),y:t.sprite.getScaleY()},h=t.sprite.getAnchorPointInPoints(),l=cc.p(h.x*s.x,h.y*s.y),a=t.sprite.getPosition(),v=t.sprite.getContentSize(),e={width:v.width*s.x,height:v.height*s.y},y=cc.p(a.x-l.x+e.width/2,a.y-l.y+e.height/2),r,f;o.type=t.type==="static"?b2Body.b2_staticBody:t.type==="dynamic"?b2Body.b2_dynamicBody:b2Body.b2_kinematicBody,o.position.Set(i(y.x),i(y.y)),o.angle=c(t.sprite.getRotation()),r=new b2FixtureDef;switch(t.shape){case"circle":r.shape=new b2CircleShape(i(t.radius||e.height/2));break;case"box":r.shape=new b2PolygonShape,r.shape.SetAsBox(i(e.width)/2,i(e.height)/2)}r.density=t.density||1,r.friction=t.friction||.5,r.restitution=t.restitution||.1,f=n.CreateBody(o),f.CreateFixture(r),t.userData&&f.SetUserData(t.userData),f.sprite=t.sprite,t.sprite.body=f,u.push(f)},simulate:function(){var l,y,s,c,r,v;for(n.Step(1/60,10,10),l=0;l<u.length;l++){var i=u[l],e=i.GetUserData(),p=i.GetPosition(),g=i.GetAngle();if(e&&(i.sprite.getPosition().x>2440||i.sprite.getPosition().x<0)&&(e.getObjectRoll()!="Bird"&&(e.isDead=!0),e.isContacted=!0),e&&e.getObjectRoll()=="Enemy"&&e.isDead){n.DestroyBody(i),t+=1e3,f++,i.sprite.runAction(cc.FadeOut.create(.5)),i.SetUserData(null),f==total_enemies&&this.set_game_over();continue}y=parseInt(document.getElementById("score_div").innerHTML),y<b2.getUserScore()&&(s=y+10,s>b2.getUserScore()&&(s=b2.getUserScore()),document.getElementById("score_div").innerHTML="000000".substr(0,6-s.toString().length)+s);var a={x:i.sprite.getScaleX(),y:i.sprite.getScaleY()},w=i.sprite.getAnchorPointInPoints(),b=cc.p(w.x*a.x,w.y*a.y),nt=i.sprite.getPosition(),k=i.sprite.getContentSize(),d={width:k.width*a.x,height:k.height*a.y};i.sprite.setPosition(cc.p(o(p.x)+b.x-d.width/2,o(p.y)+b.y-d.height/2)),i.sprite.setRotation(h(g))}if(n.ClearForces(),game.focus_pos!=-2&&!game.isPanning){if(game.focus_pos>=3)return;c=game.focus_pos>=0?game.birdSprite[game.focus_pos].getPosition():{x:1200},r=parseInt(document.getElementById("viewport").style.marginLeft),c.relativeX=c.x+r,c.relativeX>400?(game.focus_pos>=0?(game.birdSprite[game.focus_pos]._position.xprev||(game.birdSprite[game.focus_pos]._position.xprev=0),v=game.birdSprite[game.focus_pos]._position.x-game.birdSprite[game.focus_pos]._position.xprev,v>15&&(v=15),r-=v,game.birdSprite[game.focus_pos]._position.xprev=game.birdSprite[game.focus_pos]._position.x):r-=15,r>=-1200&&r<=0&&(document.getElementById("viewport").style.marginLeft=r+"px")):c.relativeX<350&&(r+=15,r>0&&(r=0),r<=0&&(document.getElementById("viewport").style.marginLeft=r+"px"))}},set_game_over:function(){var i,r,n;if(!game_over){for(game_over=!0,i="",r=4-game.current_bird,n=0;n<=2;n++)i+=r>n?"&#9733;":"&#9734;";document.getElementById("preload_div").style.display="block",document.getElementById("win_popup").style.display="block",document.getElementById("win_popup_inner").innerHTML="LEVEL CLEARED!<br>SCORE: "+t+"<br>"+i,storage["ab_level_"+level_number]=t+":"+r}},set_birds_gone:function(){var n=Math.floor(Date.now()/1e3);if(n-last_hit<3)return setTimeout("b2.set_birds_gone();",1e3);birds_gone||game.current_bird==0||(birds_gone=!0,game_over||(document.getElementById("preload_div").style.display="block",document.getElementById("win_popup").style.display="none",document.getElementById("lose_popup").style.display="block",document.getElementById("lose_popup_inner").innerHTML="LEVEL FAILED!<br>"))},debugDraw:function(t){if(s=t){var i=new b2DebugDraw;i.SetSprite(document.getElementsByTagName("canvas")[0].getContext("2d")),i.SetDrawScale(e),i.SetFillAlpha(.5),i.SetLineThickness(1),i.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit),n.SetDebugDraw(i)}}}}(),CMenu=cc.Sprite.extend({defaultScale:.8,hovered:!1,boundingBox:null,onClickCallback:null,ctor:function(n){this._super(),this.initWithTexture(n),this.setScale(this.defaultScale)},onClick:function(n){this.onClickCallback=n},handleTouches:function(){this.hovered&&this.onClickCallback&&this.onClickCallback()},handleTouchesMoved:function(n){var i=n[0].getLocation();this.boundingBox||(this.boundingBox=this.getBoundingBox()),cc.Rect.CCRectContainsPoint(this.boundingBox,i)?this.hovered||(this.hovered=!0,this.runAction(cc.ScaleTo.create(.01,1))):this.hovered&&(this.hovered=!1,this.runAction(cc.ScaleTo.create(.01,this.defaultScale)))},handleTouchesEnded:function(){}}),GameLayer=cc.Layer.extend({birdSprite:null,focus_pos:0,isDraggingSling:!1,isPanning:!1,birdStartPos:cc.p(190,210),slingRadius:{min:20,max:80},slingAngle:{min:cc.DEGREES_TO_RADIANS(250),max:cc.DEGREES_TO_RADIANS(295)},smokeDistance:16,menus:[],lastSmoke:null,slingRubber1:null,slingRubber2:null,slingRubber3:null,current_bird:0,getTexture:function(n){return cc.TextureCache.getInstance().addImage("sprites/"+n+".png")},addObject:function(n){var t=cc.Sprite.createWithTexture(this.getTexture(n.name));return t.setAnchorPoint(n.anchor||cc.p(.5,.5)),t.setScaleX(n.scaleX||n.scale||1),t.setScaleY(n.scaleY||n.scale||1),t.setRotation(n.rotation||0),t.setPosition(cc.p(n.x||0,n.y||0)),n.shape&&b2.enablePhysicsFor({type:n.type,shape:n.shape,sprite:t,radius:n.radius,density:n.density,userData:n.userData}),this.addChild(t,n.z||0),t},init:function(){resize_screen();window.onresize=resize_screen;var u,n,t,f,e,i;game?(document.getElementById("preload_div").style.display="none",document.getElementById("frontpage_div").style.display="none",document.getElementById("level_select_div").style.display="none",this.focus_pos=-2,document.getElementById("viewport").style.marginLeft="-1000px",setTimeout("pan_back(0);",3e3)):(game=this,document.onmouseup=function(){game.isPanning=!1},document.ontouchend=function(){game.isPanning=!1},document.getElementById("play_button").onclick=show_level_select,document.getElementById("play_button").innerHTML='<img src="sprites/play.png">',document.getElementById("viewport").style.cursor="url('sprites/cursor_open.cur'), pointer"),document.getElementById("win_popup").style.display="none",document.getElementById("lose_popup").style.display="none",this._super(),this.removeAllChildrenWithCleanup(!0),this.setTouchEnabled(!0),this.current_bird=0;var r=cc.Director.getInstance(),o=this,s=r.getWinSize();b2.initWorld(),u=this.addObject({name:"ground",scaleX:1,anchor:cc.p(0,0),type:"static",shape:"box",density:0}),n=[],n[0]=[{name:"wood1",x:840.5,y:71,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1017.5,y:71,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:931.5,y:131.5,scaleX:1.3,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:931.5,y:251.5,scaleX:1.3,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:880,y:330,rotation:-40,scaleX:.8,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:980,y:330,rotation:40,scaleX:.8,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:840.5,y:200.5,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1017.5,y:200.5,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:930,y:300,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:931.5,y:71,type:"dynamic",shape:"circle",density:2,userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:931.5,y:180,type:"dynamic",shape:"circle",density:2,userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[1]=[{name:"enemy",x:1002,y:90,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,150)},{name:"wood1",x:903,y:90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:904,y:171,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:903,y:252,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:903,y:333,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:901,y:415,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,150)}],n[2]=[{name:"wood1",x:726,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:722,y:173,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:910,y:88,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:911,y:169,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:909,y:251,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1090,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1091,y:175,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1092,y:257,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1085,y:338,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:722,y:193,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:908,y:271,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:1087,y:357,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[3]=[{name:"dirt",x:859,y:91,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:859,y:172,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"enemy",x:944,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,100)},{name:"dirt",x:1130,y:90,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:1130,y:171,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:1130,y:251,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"wood1",x:859,y:253,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:859,y:333,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:1040,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,100)}],n[4]=[{name:"dirt",x:748,y:92,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"enemy",x:746,y:200,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,200)},{name:"wood1",x:900,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:900,y:175,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:900,y:258,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:900,y:335,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:900,y:412,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:900,y:480,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:996,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,100)},{name:"enemy",x:1086,y:91,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,100)}],n[5]=[{name:"wood2",x:859,y:193,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1016,y:192,rotation:-271,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:934,y:295,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:946,y:91,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:938,y:317,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[12]=[{name:"dirt",x:1103,y:90,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:856,y:257,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:855,y:340,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:855,y:423,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"enemy",x:931,y:526,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood2",x:978,y:504,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"dirt",x:1104,y:422,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:1103,y:340,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:1104,y:257,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"dirt",x:1103,y:172,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"enemy",x:985,y:90,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:1018,y:170,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:941,y:234,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:855,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:855,y:175,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)}],n[7]=[{name:"wood1",x:806,y:90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:864,y:172,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:922,y:254,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:960,y:336,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1003,y:253,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1058,y:172,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1117,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:923,y:90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1005,y:90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:962,y:172,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[8]=[{name:"wood1",x:806,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:806,y:173,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:807,y:257,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:719,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:721,y:174,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:634,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:896,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:805,y:341,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:721,y:257,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:634,y:177,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[9]=[{name:"wood2",x:645,y:193,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:790,y:192,rotation:-270,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:714,y:294,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:721,y:90,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood2",x:892,y:312,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1074,y:292,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:994,y:191,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1149,y:191,rotation:-270,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:1086,y:91,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:901,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:888,y:331,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:706,y:314,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:1068,y:312,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[10]=[{name:"wood2",x:645,y:193,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:790,y:192,rotation:-270,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:714,y:294,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:721,y:90,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood2",x:892,y:312,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1074,y:292,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:994,y:191,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:1149,y:191,rotation:-270,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:1086,y:91,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:901,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:888,y:331,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:706,y:314,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:1068,y:312,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood2",x:816,y:433,rotation:-90,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:971,y:434,rotation:-270,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:892,y:536,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:893,y:558,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],n[11]=[{name:"wood1",x:772,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:951,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:854,y:174,scaleX:1.3,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:771,y:194,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:953,y:193,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:862,y:277,scaleX:1.3,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:864,y:93,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:865,y:195,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:771,y:298,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:950,y:298,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:858,y:381,scaleX:1.3,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:862,y:298,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:860,y:404,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:798,y:467,scaleX:.8,rotation:-46,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:923,y:470,scaleX:.8,rotation:-300,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)}],n[6]=[{name:"wood1",x:806,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1012,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:905,y:256,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:899,y:279,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"dirt",x:558,y:91,type:"static",shape:"box",userData:new BodyUserData(GameObjectRoll.Dirt,2e3)},{name:"wood1",x:558,y:174,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:557,y:340,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:558,y:257,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:806,y:173,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1012,y:173,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)}],n[13]=[{name:"wood1",x:786,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:952,y:91,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:869,y:92,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:785,y:176,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:786,y:260,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:785,y:342,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:951,y:173,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:952,y:255,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:952,y:340,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:867,y:172,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:869,y:257,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"wood1",x:701,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:702,y:177,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:702,y:259,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:702,y:343,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:618,y:92,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:619,y:176,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:619,y:258,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:619,y:342,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)}],n[14]=[{name:"wood1",x:773,y:91,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:788,y:173,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:804,y:256,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood2",x:891,y:336,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:992,y:254,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1009,y:172,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:1032,y:90,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:852,y:356,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"wood1",x:934,y:356,rotation:-360,type:"dynamic",shape:"box",userData:new BodyUserData(GameObjectRoll.Wood,2e3)},{name:"enemy",x:900,y:439,rotation:-360,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:910,y:91,rotation:-360,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:1129,y:92,rotation:-360,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)},{name:"enemy",x:674,y:89,rotation:-360,type:"dynamic",shape:"circle",userData:new BodyUserData(GameObjectRoll.Enemy,400)}],total_enemies=0;for(t in n[level_number])n[level_number][t].y+=30,n[level_number][t].x+=500,this.addObject(n[level_number][t]),n[level_number][t].name=="enemy"&&total_enemies++;for(this.birdSprite=[],t=0;t<3;t++)this.birdSprite[t]=this.addObject({name:"bird",x:130-t*50,y:110,z:1});f=this.addObject({name:"sling1",x:214,y:87,scale:.7,anchor:cc.p(1,0)}),e=this.addObject({name:"sling2",x:198,y:144,scale:.7,anchor:cc.p(1,0),z:3}),this.slingRubber1=this.addObject({name:"sling3",x:208,y:205,scaleY:.7,scaleX:0,anchor:cc.p(1,.5),z:0}),this.slingRubber2=this.addObject({name:"sling3",x:180,y:210,scaleY:.7,scaleX:0,anchor:cc.p(1,.5),z:2}),this.slingRubber3=null,i=cc.Spawn.create(cc.RotateBy.create(1.5,360),cc.JumpTo.create(1.5,this.birdStartPos,100,1)),this.birdSprite[this.current_bird].runAction(i),this.scheduleUpdate()},update:function(){var i,t,r,u;if(b2.simulate(),this.current_bird<3&&this.birdSprite[this.current_bird].body){if(i=this.birdSprite[this.current_bird].body.GetUserData(),t=this.birdSprite[this.current_bird].getPosition(),!i||i.isContacted){this.respawn_bird();return}r=cc.pSub(t,this.lastSmoke&&this.lastSmoke.getPosition()||cc.p(0,0)),u=cc.pLength(r),u>=this.smokeDistance&&(this.lastSmoke=this.addObject({name:"smoke",x:t.x,y:t.y,scale:Math.random()>=.5?.8:.6}))}},respawn_bird:function(){if(this.current_bird++,this.current_bird<3){var n=cc.Spawn.create(cc.RotateBy.create(1.5,360),cc.JumpTo.create(1.5,this.birdStartPos,100,1));this.birdSprite[this.current_bird].runAction(n),setTimeout("if(!game_over&&!game.isPanning){pan_back(game.current_bird);}",4e3)}else birds_gone||setTimeout("b2.set_birds_gone();",4e3)},onTouchesBegan:function(n,t){if(!game_over){if(this.isDraggingSling)return this.onTouchesEnded(n,t);if(this.current_bird<3){var i=n[0].getLocation(),r=cc.pSub(this.birdStartPos,i);(this.isDraggingSling=cc.pLength(r)<this.slingRadius.max)&&!this.birdSprite[this.current_bird].body&&!this.slingRubber3&&(this.slingRubber3=this.addObject({name:"sling3",x:i.x,y:i.y,scaleY:1.5,scaleX:2,anchor:cc.p(0,.5),z:1}))}this.isDraggingSling?document.getElementById("viewport").style.cursor="url('sprites/cursor_hold.cur'), pointer":(this.isPanning={x:n[0]._point.x*cc.Director.getInstance()._contentScaleFactor,start:0},this.focus_pos=-2)}},onTouchesMoved:function(n){var f,r,e,o;if(this.isPanning){f={x:n[0]._point.x*cc.Director.getInstance()._contentScaleFactor},r=-(this.isPanning.start+(this.isPanning.x-(f.x+parseInt(document.getElementById("viewport").style.marginLeft)))),r>0&&(r=0),r<-1200&&(r=-1200),document.getElementById("viewport").style.marginLeft=r+"px",this.focus_pos=-2;return}if(this.isDraggingSling&&!(this.current_bird>=3)&&!this.birdSprite[this.current_bird].body){this.slingRubber1.setVisible(!0),this.slingRubber2.setVisible(!0),this.slingRubber3.setVisible(!0);var f=n[0].getLocation(),s=cc.pSub(f,this.birdStartPos),u=cc.pLength(s),i=cc.pToAngle(s);i=i<0?Math.PI*2+i:i,u=MathH.clamp(u,this.slingRadius.min,this.slingRadius.max),i<=this.slingAngle.max&&i>=this.slingAngle.min&&(u=this.slingRadius.min),this.birdSprite[this.current_bird].setPosition(cc.pAdd(this.birdStartPos,cc.p(u*Math.cos(i),u*Math.sin(i)))),e=function(n,t,i,r){var e=n.getPosition(),o=cc.pSub(t,e),f=cc.pToAngle(o),s=cc.RADIANS_TO_DEGREES(f),u=cc.pLength(o)+(i||8);n.setRotation(-s),n.setScaleX(-(u/n.getContentSize().width)),r&&(n.setScaleY(1.1-.7/this.slingRadius.max*u),this.slingRubber3.setRotation(-s),this.slingRubber3.setPosition(cc.pAdd(e,cc.p(u*Math.cos(f),u*Math.sin(f)))))}.bind(this),o=this.birdSprite[this.current_bird].getPosition(),e(this.slingRubber2,o,13,!0),e(this.slingRubber1,o,0),this.slingRubber1.setScaleY(this.slingRubber2.getScaleY())}},onTouchesEnded:function(){if(document.getElementById("viewport").style.cursor="url('sprites/cursor_open.cur'), pointer",this.isPanning){this.isPanning=!1;return}if(!(this.current_bird>=3)&&!this.birdSprite[this.current_bird].body&&this.isDraggingSling){this.slingRubber1.setVisible(!1),this.slingRubber2.setVisible(!1),this.slingRubber3.setVisible(!1),b2.enablePhysicsFor({type:"dynamic",shape:"circle",sprite:this.birdSprite[this.current_bird],density:15,restitution:.4,userData:new BodyUserData(GameObjectRoll.Bird,250)});var i=cc.pSub(this.birdStartPos,this.birdSprite[this.current_bird].getPosition()),r=cc.pMult(i,12),u=this.birdSprite[this.current_bird].body.GetWorldCenter();this.birdSprite[this.current_bird].body.ApplyImpulse(r,u),sounds[0].play(),this.focus_pos=this.current_bird,this.isDraggingSling=!1}},onKeyUp:function(){},onKeyDown:function(){}}),GameScene=cc.Scene.extend({onEnter:function(){this._super();var n=new GameLayer;n.init(),this.addChild(n)}}),game=!1,level_number=0,birds_gone=!1,game_over=!1,total_enemies=0,creating_world=!1,last_hit=Math.floor(Date.now()/1e3),oggs=["sound_launch","sound_hit","sound_hit","sound_hit","sound_hit","sound_hit"],sounds=new Array(oggs.length),sound_instance=1;for(j=0;j<oggs.length;j++)sounds[j]=new Audio(""),sounds[j].src="sound/"+oggs[j]+".mp3",j>0&&(sounds[j].volume=.2);typeof document.oncontextmenu!="undefined"?document.oncontextmenu=ce:document.onclick=nrc,typeof document.onselectstart!="undefined"&&(document.onselectstart=ce)